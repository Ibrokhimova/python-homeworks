import csv
from collections import defaultdict

# 1. grades.csv faylini yaratish va ma'lumotlarni yozish
grades_data = [
    ["Name", "Subject", "Grade"],
    ["Alice", "Math", 85],
    ["Bob", "Science", 78],
    ["Carol", "Math", 92],
    ["Dave", "History", 74]
]

with open("grades.csv", "w", newline="") as file:
    writer = csv.writer(file)
    writer.writerows(grades_data)

# 2. CSV fayldan ma'lumotlarni o'qish
grades = []
with open("grades.csv", "r") as file:
    reader = csv.DictReader(file)
    for row in reader:
        row["Grade"] = int(row["Grade"])  # Bahoni butun son (int) ga aylantirish
        grades.append(row)

# 3. Fanlar bo'yicha o'rtacha bahoni hisoblash
subject_totals = defaultdict(list)
for entry in grades:
    subject = entry["Subject"]
    grade = entry["Grade"]
    subject_totals[subject].append(grade)

# 4. Har bir fan uchun o'rtacha bahoni hisoblash
average_grades = []
for subject, grades_list in subject_totals.items():
    average = sum(grades_list) / len(grades_list)
    average_grades.append({
        "Subject": subject,
        "Average Grade": round(average, 1)
    })

# 5. Natijani average_grades.csv fayliga yozish
with open("average_grades.csv", "w", newline="") as file:
    fieldnames = ["Subject", "Average Grade"]
    writer = csv.DictWriter(file, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(average_grades)

print(" average_grades.csv fayli muvaffaqiyatli yaratildi.")
